<!-- banner -->
<div class="show-banner" style="background-image: linear-gradient(-225deg, rgba(0,101,168,0.6) 0%, rgba(0,36,61,0.6) 50%), url(<%= image_path "sports-photos/#{@event.sport.name}.jpg" %>); width: 100%; background-size: cover; height: 40vh; background-position: center;">
  <div class="container text-center">
    <h1 style="padding-top: 10vh; font-size: 50px">
      <span class="banner-event-title"> <%= @event.title %> | </span>
      <span class="banner-sport-name"> <%= @event.sport.name %> </span>
    </h1>
  </div>
  <div class="edit-delete">
    <%= link_to edit_event_path(@event) do %>
      <i class="fa fa-pencil fa-2x" aria-hidden="true"></i>
    <% end %>
    <%= link_to @event, method: :delete, data: { confirm: 'Are you sure?' } do%>
      <i class="fa fa-trash-o fa-2x" aria-hidden="true"></i>
    <% end %>
  </div>
</div>

<!-- details -->
<div class="container">
  <div class="row">
    <div class="col-xs-12 col-md-8">
      <h3>Number of players needed:
        <% @event.missing_player.times do %>
          <i class="fa fa-user missing_player" aria-hidden="true"></i>
        <% end %>
      </h3>
      <h3>Date:</h3>
      <p>
        <% if @event.start_time.to_date == @event.end_time.to_date %>
          <%= @event.start_time.strftime("%A %d %B") %>
        <% else %>
          <%= @event.start_time.strftime("%A %d %B") %> - <%= @event.end_time.strftime("%A %d %B") %>
        <% end %>
      </p>
      <h3>Time:</h3>
        <% if @event.start_time.to_date == @event.end_time.to_date %>
          <%= @event.start_time.strftime("%H:%M") %> - <%= @event.end_time.strftime("%H:%M") %>
        <% else %>
          <%= @event.start_time.strftime("%H:%M") %> <span class="grey-text">(<%= @event.start_time.strftime("%A %d") %>)</span> - <%= @event.end_time.strftime("%H:%M") %> <span class="grey-text">(<%= @event.end_time.strftime("%A %d") %>)</span>
        <% end %>
      <h3>Description:</h3>
      <p><%= @event.description %></p>
<!-- buttons -->
      <div class="row buttons-show">
        <div class="col-xs-8">
          <div class="booking-button-show text-center">
            <%= render 'bookings/form' %>
          </div>
        </div>
        <div class="col-xs-4">
          <div class="chat-button-show text-center">
            <% if @event.user.id != current_user.id %>
              <%= link_to 'Chat to Event owner', conversations_path(sender_id: current_user.id, recipient_id: @event.user.id), method: "post", class: "btn btn-success btn-lg"%>
            <% end %>
          </div>
        </div>
      </div>
    </div>
<!-- map -->
    <div class="col-xs-12 col-md-4">
      <h3>Location:</h3>
      <p><%= @event.g_address %></p>
      <div id="map" style="width: 100%; height: 375px;"></div>
    </div>
  </div>
</div>
<br>


 <script>
  <% content_for(:after_js) do %>
    <%= javascript_tag do %>
      $(document).on('ready', function() {
        var handler = Gmaps.build('Google');
        handler.buildMap({ internal: { id: 'map' } }, function(){

         <% @hash = Gmaps4rails.build_markers(@event) do |event, marker| %>
           markers = handler.addMarkers([
               {
                 lat: <%= event.latitude %>,
                 lng: <%= event.longitude %>,
                 picture: {
                   url: "<%= image_path ("sports/thumbnails/" + event.sport.name + ".png") %>",
                   width:  50,
                   height: 50
                 }
               }
             ]);
           <% end %>

         markers.forEach(function(marker) {
           handler.bounds.extendWith(marker);
         });
         handler.fitMapToBounds();
        handler.getMap().setZoom(14);
       });
      });
    <% end %>
  <% end %>
</script>
